"use strict";function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(t,!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(t).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _objectWithoutProperties(e,r){if(null==e)return{};var t,n,s=_objectWithoutPropertiesLoose(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],0<=r.indexOf(t)||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}function _objectWithoutPropertiesLoose(e,r){if(null==e)return{};var t,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],0<=r.indexOf(t)||(s[t]=e[t]);return s}var User=require("../models/user.model"),jwt=require("jsonwebtoken"),bcrypt=require("bcrypt"),login=function(r,t){var n,s,a,o,u,i,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.body,s=n.username,a=n.password,s&&a){e.next=4;break}return t.status(400).send({message:"All fields are required"}),e.abrupt("return");case 4:return e.next=6,regeneratorRuntime.awrap(User.findOne({username:s}));case 6:return(o=e.sent)||t.status(400).send({message:"Invalid username/password"}),e.next=10,regeneratorRuntime.awrap(bcrypt.compare(a,o.password));case 10:if(e.sent){e.next=14;break}return t.status(400).send({message:"Invalid username/password"}),e.abrupt("return");case 14:u=o.toJSON(),u.password,u._id,i=_objectWithoutProperties(u,["password","_id"]),c=jwt.sign(_objectSpread({},i),"MARGO",{expiresIn:"2 days"}),t.status(200).send({user:i,token:c,message:"Signed In"});case 17:case"end":return e.stop()}})},register=function(r,t){var n,s,a,o,u,i,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.body,s=n.username,a=n.password,o=n.firstName,u=n.lastName,i=n.admin,s&&a&&o&&u||t.status(400).send({message:"all fields are required"}),e.prev=2,c=new User({username:s,password:a,firstName:o,lastName:u,admin:i}),e.next=6,regeneratorRuntime.awrap(c.save());case 6:t.status(200).send({user:c}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t.status(500).send({error:e.t0});case 12:case"end":return e.stop()}},null,null,[[2,9]])};module.exports={login:login,register:register};
//# sourceMappingURL=auth.controllers.min.js.map
